<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="一个二进制协议，不记录一下容易忘，看wiki太慢"><title>SOCKS 协议交互流程记录</title><link rel=canonical href=https://aladdinding.cn/post/socks-%E5%8D%8F%E8%AE%AE%E4%BA%A4%E4%BA%92%E6%B5%81%E7%A8%8B%E8%AE%B0%E5%BD%95/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property="og:title" content="SOCKS 协议交互流程记录"><meta property="og:description" content="一个二进制协议，不记录一下容易忘，看wiki太慢"><meta property="og:url" content="https://aladdinding.cn/post/socks-%E5%8D%8F%E8%AE%AE%E4%BA%A4%E4%BA%92%E6%B5%81%E7%A8%8B%E8%AE%B0%E5%BD%95/"><meta property="og:site_name" content="大猫的博客"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="socks"><meta property="article:tag" content="网络协议"><meta property="article:published_time" content="2020-07-19T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-19T00:00:00+00:00"><meta name=twitter:title content="SOCKS 协议交互流程记录"><meta name=twitter:description content="一个二进制协议，不记录一下容易忘，看wiki太慢"><link rel="shortcut icon" href=https://img.aladdinding.cn/lion.png></head><body class=article-page><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu86d3dbbac91a1a793adc237918d8b49d_16968_300x0_resize_box_2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>大猫的博客</a></h1><h2 class=site-description>博观而约取，厚积而薄发。</h2></div></header><ol class=social-menu><li><a href=https://github.com/munding target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/arcustin target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li><a href=mailto:aladdinding@qq.com target=_blank title=Mail><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>主页</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>时间轴</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>搜索</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>关于</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/post/socks-%E5%8D%8F%E8%AE%AE%E4%BA%A4%E4%BA%92%E6%B5%81%E7%A8%8B%E8%AE%B0%E5%BD%95/>SOCKS 协议交互流程记录</a></h2><h3 class=article-subtitle>一个二进制协议，不记录一下容易忘，看wiki太慢</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jul 19, 2020</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 4 分钟</time></div></footer></div></header><section class=article-content><blockquote><p>SOCKS 是一种网络传输协议，主要用于客户端与外网服务器之间通讯的中间传递。SOCKS 是 &ldquo;Socket Secure&rdquo; 的缩写。当防火墙后的客户端要访问外部的服务器时，就跟 SOCKS 代理服务器连接。这个代理服务器控制客户端访问外网的资格，允许的话，就将客户端的请求发往外部的服务器。这个协议最初由 David Koblas 开发，而后由 NEC 的 Ying-Da Lee 将其扩展到 SOCKS4。最新协议是 SOCKS5，与前一版本相比，增加支持 <a class=link href=https://zh.wikipedia.org/wiki target=_blank rel=noopener>UDP（用户数据报协议）</a>、验证，以及 <a class=link href=https://zh.wikipedia.org/wiki/IPv6 target=_blank rel=noopener>IPv6</a>。根据 <a class=link href=https://zh.wikipedia.org/wiki/OSI target=_blank rel=noopener>OSI 模型</a>，SOCKS 是 <a class=link href=https://zh.wikipedia.org/wiki target=_blank rel=noopener>会话层</a> 的协议，位于 <a class=link href=https://zh.wikipedia.org/wiki target=_blank rel=noopener>表示层</a> 与 <a class=link href=https://zh.wikipedia.org/wiki target=_blank rel=noopener>传输层</a> 之间。SOCKS 协议不提供 <a class=link href=https://zh.wikipedia.org/wiki target=_blank rel=noopener>加密</a>。</p></blockquote><h1 id=socks5>SOCKS5</h1><h2 id=socks-协议版本认证>SOCKS 协议版本认证</h2><p>创建与 SOCKS5 服务器的 TCP 连接后客户端需要先发送请求来确认协议版本及认证方式（以字节为单位）</p><h3 id=client-send>client send</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +----+----------+----------+
# |VER | NMETHODS | METHODS  |
# +----+----------+----------+
# | 1  |    1     | 1 to 255 |
# +----+----------+----------+
</code></pre></div><ul><li>VER：SOCKS5 协议版本 0x05</li><li>NMETHODS：METHODS 所占字节长度</li><li>METHODS：客户端支持的认证方式列表，每个方法占 1 字节<ul><li>0x00 不需要认证</li><li>0x01 GSSAPI</li><li>0x02 用户名、密码认证</li><li>0x03 to 0x7F 由 IANA 分配（保留）</li><li>0x80 to 0xFE 私人方法保留</li><li>0xFF 无可接受的方法</li></ul></li></ul><p>服务器从客户端提供的 <code>METHODS</code> 中选择一个并通过以下消息通知客户端</p><h3 id=server-reply>server reply</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +----+--------+
# |VER | METHOD |
# +----+--------+
# | 1  |   1    |
# +----+--------+
</code></pre></div><ul><li><p>VER：协议版本 0x05</p></li><li><p>METHOD：服务端选中的方法。如果返回 0xFF 表示没有一个认证方法被选中，客户端需要关闭连接。</p></li></ul><h2 id=socks-用户名密码认证>SOCKS 用户名密码认证</h2><p>如果 SOCKS 协议版本认证中服务端返回的 <code>METHOD</code> 是 <code>0x02</code>，即需要用户名密码认证，则客户端会发送用户名密码认证信息。如果返回的 <code>METHOD</code> 是 <code>0x00</code>，即不需要认证，直接跳转下一步发送 SOCKS 请求信息。</p><h3 id=client-send-1>client send</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +----+------+----------+------+----------+
# |VER | ULEN |  UNAME   | PLEN |  PASSWD  |
# +----+------+----------+------+----------+
# | 1  |  1   | 1 to 255 |  1   | 1 to 255 |
# +----+------+----------+------+----------+
</code></pre></div><ul><li>VER：认证协议版本 0x01</li><li>ULEN：用户名长度</li><li>UNAME： 用户名</li><li>PLEN：密码长度</li><li>PASSWD：密码</li></ul><h3 id=server-reply-1>server reply</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +----+--------+
# |VER | STATUS |
# +----+--------+
# | 1  |   1    |
# +----+--------+
</code></pre></div><ul><li>VER：认证协议版本 0x01</li><li>STATUS：认证状态<ul><li>0x00 成功</li><li>0x01 失败</li></ul></li></ul><h2 id=发送-socks-请求信息>发送 SOCKS 请求信息</h2><p>认证结束后客户端就可以发送请求信息。如果认证方法有特殊封装要求，请求必须按照方法所定义的方式进行封装。</p><h3 id=client-send-2>client send</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +----+-----+-------+------+----------+----------+
# |VER | CMD |  RSV  | ATYP | DST.ADDR | DST.PORT |
# +----+-----+-------+------+----------+----------+
# | 1  |  1  | X&#39;00&#39; |  1   | Variable |    2     |
# +----+-----+-------+------+----------+----------+
</code></pre></div><ul><li>VER：SOCKS5 协议版本 0x05</li><li>CMD：SOCK 命令码<ul><li>0x01 CONNECT 请求</li><li>0x02 BIND 请求</li><li>0x03 UDP 转发</li></ul></li><li>RSV：0x00 保留</li><li>ATYP：DST.ADDR 类型<ul><li>0x01 IPv4 地址，DST.ADDR 部分 4 字节长度</li><li>0x03 域名，DST.ADDR 部分第一个字节为域名长度，DST.ADDR 剩余的内容为域名，没有 \ 0 结尾。</li><li>0x04 IPv6 地址，16 个字节长度。</li></ul></li><li>DST.ADDR：目的地址</li><li>DST.PORT：网络字节序表示的目的端口</li></ul><h3 id=server-reply-2>server reply</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +----+-----+-------+------+----------+----------+
# |VER | REP |  RSV  | ATYP | BND.ADDR | BND.PORT |
# +----+-----+-------+------+----------+----------+
# | 1  |  1  | X&#39;00&#39; |  1   | Variable |    2     |
# +----+-----+-------+------+----------+----------+
</code></pre></div><ul><li>VER：SOCKS5 协议版本 0x05</li><li>REP：应答字段<ul><li>0x00 成功</li><li>0x01 常规 SOCKS 服务器连接失败</li><li>0x02 现有规则不允许连接</li><li>0x03 网络不可达</li><li>0x04 主机不可达</li><li>0x05 连接被拒</li><li>0x06 TTL 超时</li><li>0x07 不支持的命令</li><li>0x08 不支持的地址类型</li><li>0x09 to 0xFF 未定义</li></ul></li><li>RSV：0x00 保留</li><li>ATYP：BND.ADDR 类型<ul><li>0x01 IPv4 地址，DST.ADDR 部分 4 字节长度</li><li>0x03 域名，DST.ADDR 部分第一个字节为域名长度，DST.ADDR 剩余的内容为域名，没有 \ 0 结尾。</li><li>0x04 IPv6 地址，16 个字节长度。</li></ul></li><li>BND.ADDR：服务器绑定的地址</li><li>BND.PORT：网络字节序表示的服务器绑定的端口</li></ul><p>当服务端返回 <code>REP</code> 应答字段为 <code>0x00</code>，即成功时，客户端和服务端之间进行数据透传，完成 SOCKS5 代理。</p><h1 id=socks4>SOCKS4</h1><p>SOCKS 4 只支持 TCP 转发</p><h2 id=发送-socks-请求信息-1>发送 SOCKS 请求信息</h2><h3 id=client-send-3>client send</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +----+------+----------+--------+----------+----------+
# |VN  | CD   |  DSTPORT |  DSTIP |  USERID  |   NULL   |
# +----+------+----------+--------+----------+----------+
# | 1  |  1   |     2    |   4    | variable |    1     |
# +----+------+----------+--------+----------+----------+
</code></pre></div><ul><li>VN：SOCKS4 协议版本 0x04</li><li>CD：SOCK 命令码<ul><li>0x01 CONNECT 请求</li><li>0x02 BIND 请求</li></ul></li><li>DSTPORT：目的主机的端口</li><li>DSTIP：目的主机的 IP 地址</li><li>USERID：用户 USERID</li><li>NULL：0x00</li></ul><h3 id=server-reply-3>server reply</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +-------+-------+----------+-----------+
# |  VN   |   CD  |  DSTPORT |   DSTIP   |
# +-------+-------+----------+-----------+
# |   1   |   1   |     2    |     4     |
# +-------+-------+----------+-----------+
</code></pre></div><ul><li>VN：回复代码的版本，应为 0x00（注意不是 0x04)</li><li>CD：SOCK 命令码<ul><li>90(0x5a) 请求得到允许；</li><li>91(0x5b) 请求被拒绝或失败；</li><li>92(0x5c) 由于 SOCKS 服务器无法连接到客户端的 identd（一个验证身份的进程），请求被拒绝；</li><li>93(0x5d) 由于客户端程序与 identd 报告的用户身份不同，连接被拒绝。</li></ul></li><li>DSTPORT：目的主机的端口（和请求包中相同）</li><li>DSTIP：目的主机的 IP 地址（和请求包中相同）</li></ul><p>当服务端返回 <code>CD</code> 字段为 <code>90(0x5a)</code>，即允许时，客户端和服务端之间进行数据透传，完成 SOCKS4 代理。</p><h1 id=socks4a>SOCKS4a</h1><p>SOCKS4a 协议是 SOCKS4 的一个补丁版，可以在 SOCKS4a 代理服务器上完成 DNS 解析</p><h2 id=发送-socks-请求信息-2>发送 SOCKS 请求信息</h2><h3 id=client-send-4>client send</h3><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback># +----+------+----------+--------+----------+----------+------------+----------+
# |VN  | CD   |  DSTPORT |  DSTIP |  USERID  |   NULL   |  HOSTNAME  |   NULL   |
# +----+------+----------+--------+----------+----------+------------+----------+
# | 1  |  1   |     2    |    4   | variable |    1     |  variable  |    1     |
# +----+------+----------+--------+----------+----------+------------+----------+
</code></pre></div><ul><li>DSTIP：0.0.0.x，其中 x 是非零，一般都为 1。（原文：such an address is inadmissible as a destination IP address and thus should never occur if the client can resolve the domain name）</li><li>HOSTNAME：域名</li></ul><p>其余字段和 SOCKS4 相同</p><h3 id=server-reply-4>server reply</h3><p>SOCKS4a 代理首先把 <code>HOSTNAME</code> 如：www.example.com 解析成对应的主机 IP 地址，并且和 IP 地址连接上，再向客户端发送和 SOCKS4 一样的响应。当服务端返回 <code>CD</code> 字段为 <code>90(0x5a)</code>，即允许时，客户端和服务端之间进行数据透传，完成 SOCKS4a 代理。</p><h1 id=socks4socks4a-和-socks5-的区别>SOCKS4，SOCKS4a 和 SOCKS5 的区别</h1><p>比如浏览器使用 SOCKS4 代理访问 <code>www.baidu.com</code>，浏览器先用本地的 DNS 解析把 <code>www.baidu.com</code> 转换成对应的 IP 地址，然后向 SOCKS4 服务器发送报文。如果此时我们的电脑受限本地完成不了 DNS 解析，那怎么办呢？SOCKS4a 就是解决这样的问题的，客户端可以把域名发送到 SOCKS4a 服务器上完成 DNS 解析，发送的 <code>DSTIP</code> 则为 0.0.0.1 这样的假 IP，然后就是和 SOCKS4 一样进行数据转发。SOCKS5 代理和 SOCKS4 SOCKS4a 比，多了一个验证功能和 udp 代理的功能。</p><h1 id=socks-协议-rfc>SOCKS 协议 RFC</h1><ul><li><a class=link href=https://github.com/cfcs/ocaml-socks/blob/master/rfc/SOCKS4.protocol.txt target=_blank rel=noopener>SOCKS4.protocol.txt</a> and <a class=link href=https://github.com/cfcs/ocaml-socks/blob/master/rfc/SOCKS4A.protocol.txt target=_blank rel=noopener>SOCKS4A.protocol.txt</a> for <code>SOCKS 4</code> and the <code>SOCKS 4A</code> extension, respectively.</li><li><a class=link href=https://github.com/cfcs/ocaml-socks/blob/master/rfc/SOCKS5_rfc1928.txt target=_blank rel=noopener>SOCKS5_rfc1928.txt</a> and <a class=link href=https://github.com/cfcs/ocaml-socks/blob/master/rfc/SOCKS5_rfc1929.txt target=_blank rel=noopener>SOCKS5_rfc1929.txt</a> for <code>SOCKS 5</code>, and <code>SOCKS 5 Username/Password authentication</code>.</li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/socks/>socks</a>
<a href=/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/>网络协议</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><script src=https://utteranc.es/client.js repo=munding/aladdinding.github.io issue-term=og:title crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(b){let a=document.querySelector('.utterances iframe');a&&a.contentWindow.postMessage({type:'set-theme',theme:`github-${b}`},'https://utteranc.es')}addEventListener('message',a=>{if(a.origin!=='https://utteranc.es')return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener('onColorSchemeChange',a=>{setUtterancesTheme(a.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2019 -
2022 大猫的博客</section><section class=powerby><a href=https://beian.miit.gov.cn/ rel="noopener noreferrer" target=_blank>鄂ICP备2021016339号-1</a><br>Power by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#socks5>SOCKS5</a><ol><li><a href=#socks-协议版本认证>SOCKS 协议版本认证</a><ol><li><a href=#client-send>client send</a></li><li><a href=#server-reply>server reply</a></li></ol></li><li><a href=#socks-用户名密码认证>SOCKS 用户名密码认证</a><ol><li><a href=#client-send-1>client send</a></li><li><a href=#server-reply-1>server reply</a></li></ol></li><li><a href=#发送-socks-请求信息>发送 SOCKS 请求信息</a><ol><li><a href=#client-send-2>client send</a></li><li><a href=#server-reply-2>server reply</a></li></ol></li></ol></li><li><a href=#socks4>SOCKS4</a><ol><li><a href=#发送-socks-请求信息-1>发送 SOCKS 请求信息</a><ol><li><a href=#client-send-3>client send</a></li><li><a href=#server-reply-3>server reply</a></li></ol></li></ol></li><li><a href=#socks4a>SOCKS4a</a><ol><li><a href=#发送-socks-请求信息-2>发送 SOCKS 请求信息</a><ol><li><a href=#client-send-4>client send</a></li><li><a href=#server-reply-4>server reply</a></li></ol></li></ol></li><li><a href=#socks4socks4a-和-socks5-的区别>SOCKS4，SOCKS4a 和 SOCKS5 的区别</a></li><li><a href=#socks-协议-rfc>SOCKS 协议 RFC</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script></body></html>